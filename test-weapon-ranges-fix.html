<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - Correction des Ranges d'Armes</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .fix { background: #e8f5e8; padding: 15px; border-left: 4px solid #4caf50; margin: 10px 0; }
        .bug { background: #ffe8e8; padding: 15px; border-left: 4px solid #f44336; margin: 10px 0; }
        .code { background: #f5f5f5; padding: 10px; border-radius: 4px; font-family: monospace; }
        h2 { color: #2196f3; }
        h3 { color: #ff9800; }
    </style>
</head>
<body>
    <h1>üîß Test - Correction des Ranges d'Armes</h1>
    
    <h2>üêõ Probl√®mes Identifi√©s</h2>
    
    <div class="bug">
        <h3>1. Ranges des Armes Martialit√© Non Affich√©s</h3>
        <p><strong>Probl√®me :</strong> Les armes de type "strength" (martialit√©) n'affichent pas leurs ranges d'attaque.</p>
        <p><strong>Cause :</strong> La fonction <code>_updateWeaponDiceRanges()</code> ne d√©tectait pas correctement le type d'arme "strength".</p>
    </div>
    
    <div class="bug">
        <h3>2. Affichage Incorrect de la Qualit√©</h3>
        <p><strong>Probl√®me :</strong> Les options du select de qualit√© montrent des entiers (0, 1, 2, 3, 4, 5) au lieu des d√©s correspondants.</p>
        <p><strong>Cause :</strong> Le template HTML affichait les valeurs num√©riques au lieu des formules de d√©s.</p>
    </div>
    
    <h2>‚úÖ Corrections Appliqu√©es</h2>
    
    <div class="fix">
        <h3>1. Correction de la D√©tection des Types d'Armes</h3>
        <p><strong>Fichier :</strong> <code>scripts/heros-sheet.js</code></p>
        <p><strong>Fonction :</strong> <code>_updateWeaponDiceRanges()</code></p>
        <p><strong>Modification :</strong> Ajout de v√©rifications explicites pour les types d'armes :</p>
        <div class="code">
// Avant (incomplet)
if (weaponType.includes('martialit√©') || weaponType.includes('force')) {

// Apr√®s (complet)
if (weaponType === 'strength' || weaponType.includes('martialit√©') || weaponType.includes('force')) {
        </div>
        <p><strong>R√©sultat :</strong> Les armes de type "strength" sont maintenant correctement d√©tect√©es et leurs ranges sont calcul√©s.</p>
    </div>
    
    <div class="fix">
        <h3>2. Correction de l'Affichage de la Qualit√©</h3>
        <p><strong>Fichier :</strong> <code>templates/sheets/heros-sheet.html</strong></p>
        <p><strong>Modification :</strong> Mise √† jour des options du select pour afficher les d√©s :</p>
        <div class="code">
// Avant
<option value="0">√âquipement bris√© (0)</option>
<option value="1">√âquipement commun (1)</option>
<option value="2">√âquipement de qualit√© (2)</option>

// Apr√®s
<option value="0">√âquipement bris√© (1d4)</option>
<option value="1">√âquipement commun (1d6)</option>
<option value="2">√âquipement de qualit√© (1d8)</option>
        </div>
        <p><strong>R√©sultat :</strong> Les utilisateurs voient maintenant clairement quel d√© est utilis√© pour chaque niveau de qualit√©.</p>
    </div>
    
    <div class="fix">
        <h3>3. Ajout de Logs de D√©bogage</h3>
        <p><strong>Fichier :</strong> <code>scripts/heros-sheet.js</code></p>
        <p><strong>Modification :</strong> Ajout de logs pour faciliter le d√©bogage :</p>
        <div class="code">
console.log('=== Debug _updateWeaponDiceRanges ===');
console.log(`Slot ${index}: weaponType = "${weaponType}"`);
console.log(`Weapon type "${weaponType}" mapped to martialite: ${statValue}`);
        </div>
        <p><strong>R√©sultat :</strong> Plus facile de diagnostiquer les probl√®mes futurs avec les ranges d'armes.</p>
    </div>
    
    <h2>üéØ Fonctionnement Attendu</h2>
    
    <div class="fix">
        <h3>Arme de Type "Strength" (Martialit√©)</h3>
        <ul>
            <li>‚úÖ Type d√©tect√© comme "strength"</li>
            <li>‚úÖ Caract√©ristique mapp√©e √† "martialite"</li>
            <li>‚úÖ Ranges calcul√©s avec les d√©s de martialit√©</li>
            <li>‚úÖ Bonus de traits appliqu√©s</li>
            <li>‚úÖ Qualit√© d'arme int√©gr√©e</li>
        </ul>
    </div>
    
    <div class="fix">
        <h3>Affichage de la Qualit√©</h3>
        <ul>
            <li>‚úÖ √âquipement bris√© ‚Üí 1d4</li>
            <li>‚úÖ √âquipement commun ‚Üí 1d6</li>
            <li>‚úÖ √âquipement de qualit√© ‚Üí 1d8</li>
            <li>‚úÖ √âquipement rare ‚Üí 1d10</li>
            <li>‚úÖ √âquipement exceptionnel ‚Üí 1d12</li>
            <li>‚úÖ √âquipement l√©gendaire ‚Üí 1d20</li>
        </ul>
    </div>
    
    <h2>üß™ Tests √† Effectuer</h2>
    
    <div class="fix">
        <h3>1. Test de D√©tection du Type</h3>
        <p>Cr√©er une arme de type "Force (Martialit√©)" et v√©rifier que :</p>
        <ul>
            <li>Le type est d√©tect√© comme "strength"</li>
            <li>La caract√©ristique est mapp√©e √† "martialite"</li>
            <li>Les ranges sont calcul√©s et affich√©s</li>
        </ul>
    </div>
    
    <div class="fix">
        <h3>2. Test de l'Affichage de la Qualit√©</h3>
        <p>Changer la qualit√© d'une arme et v√©rifier que :</p>
        <ul>
            <li>Les options montrent les d√©s (1d4, 1d6, 1d8, etc.)</li>
            <li>La s√©lection fonctionne correctement</li>
            <li>Les ranges se mettent √† jour selon la qualit√©</li>
        </ul>
    </div>
    
    <div class="fix">
        <h3>3. Test des Ranges en Temps R√©el</h3>
        <p>Modifier les caract√©ristiques et v√©rifier que :</p>
        <ul>
            <li>Les ranges se mettent √† jour automatiquement</li>
            <li>Les bonus de traits sont appliqu√©s</li>
            <li>Les malus d'armure sont pris en compte (pour l'agilit√©)</li>
        </ul>
    </div>
    
    <h2>üìã Fichiers Modifi√©s</h2>
    
    <ul>
        <li><strong>templates/sheets/heros-sheet.html</strong> - Affichage des d√©s de qualit√©</li>
        <li><strong>scripts/heros-sheet.js</strong> - D√©tection des types d'armes et logs de d√©bogage</li>
    </ul>
    
    <h2>üéâ R√©sultat Attendu</h2>
    
    <p>Apr√®s ces corrections, les armes de type martialit√© devraient :</p>
    <ul>
        <li>‚úÖ Afficher correctement leurs ranges d'attaque</li>
        <li>‚úÖ Montrer les d√©s de qualit√© dans les selects</li>
        <li>‚úÖ Mettre √† jour les ranges en temps r√©el</li>
        <li>‚úÖ Int√©grer tous les bonus et malus</li>
    </ul>
    
    <p><strong>Status :</strong> üü¢ Corrections appliqu√©es et pr√™tes pour test</p>
    
    <hr>
    <p><em>Test cr√©√© le 19 d√©cembre 2024 - Version 0.1.0</em></p>
</body>
</html>
