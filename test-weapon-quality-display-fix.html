<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - Affichage de la Qualit√© des Armes</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .code-block {
            background: #f4f4f4;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
            margin: 10px 0;
        }
        .success {
            color: #28a745;
            font-weight: bold;
        }
        .info {
            color: #17a2b8;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>Test - Affichage de la Qualit√© des Armes</h1>
    
    <div class="test-section">
        <h2>üéØ Objectif</h2>
        <p>Modifier l'affichage en mode lecture de la qualit√© des armes et boucliers pour montrer √† la fois le label descriptif et le bonus de d√©s accord√©.</p>
    </div>

    <div class="test-section">
        <h2>üêõ Probl√®me Identifi√©</h2>
        <p>En mode lecture, la qualit√© des armes et boucliers n'affichait que :</p>
        <ul>
            <li><strong>Rang 0 :</strong> "√âquipement bris√©" ‚úÖ (correct)</li>
            <li><strong>Rangs 1-5 :</strong> Juste le nombre (1, 2, 3, 4, 5) ‚ùå (incorrect)</li>
        </ul>
        <p>L'utilisateur souhaitait voir : <strong>"√âquipement commun (1d6)"</strong> au lieu de juste <strong>"1"</strong></p>
    </div>

    <div class="test-section">
        <h2>üîß Solution Impl√©ment√©e</h2>
        
        <h3>1. Nouvelle Fonction Helper JavaScript</h3>
        <div class="code-block">/**
 * Retourne le label descriptif pour la qualit√© d'une arme
 * @param {string} rank - Le rang de qualit√© (0-5)
 * @returns {string} - Le label descriptif (ex: "√âquipement bris√©")
 * @private
 */
_getWeaponQualityLabel(rank) {
    const qualityLabelMap = {
        "0": "√âquipement bris√©",
        "1": "√âquipement commun",
        "2": "√âquipement de qualit√©",
        "3": "√âquipement rare",
        "4": "√âquipement exceptionnel",
        "5": "√âquipement l√©gendaire"
    };
    return qualityLabelMap[rank] || "√âquipement bris√©";
}</div>

        <h3>2. Helpers Handlebars Enregistr√©s</h3>
        <div class="code-block">// Helpers pour la qualit√© des armes
Handlebars.registerHelper('getWeaponQualityLabel', function(rank) {
    const qualityLabelMap = {
        "0": "√âquipement bris√©",
        "1": "√âquipement commun",
        "2": "√âquipement de qualit√©",
        "3": "√âquipement rare",
        "4": "√âquipement exceptionnel",
        "5": "√âquipement l√©gendaire"
    };
    return qualityLabelMap[rank] || "√âquipement bris√©";
});

Handlebars.registerHelper('getWeaponQualityDice', function(rank) {
    const qualityDiceMap = {
        "0": "1d4",
        "1": "1d6",
        "2": "1d8",
        "3": "1d10",
        "4": "1d12",
        "5": "1d20"
    };
    return qualityDiceMap[rank] || "1d4";
});</div>

        <h3>3. Template HTML Mis √† Jour</h3>
        <p><strong>Avant :</strong></p>
        <div class="code-block">&lt;div class="read-mode"&gt;{{#if (eq actor.system.weapons.primary.rank "0")}}√âquipement bris√©{{else}}{{actor.system.weapons.primary.rank}}{{/if}}&lt;/div&gt;</div>
        
        <p><strong>Apr√®s :</strong></p>
        <div class="code-block">&lt;div class="read-mode"&gt;{{getWeaponQualityLabel actor.system.weapons.primary.rank}} ({{getWeaponQualityDice actor.system.weapons.primary.rank}})&lt;/div&gt;</div>
    </div>

    <div class="test-section">
        <h2>‚úÖ R√©sultat Attendu</h2>
        <p>En mode lecture, la qualit√© des armes et boucliers affiche maintenant :</p>
        <ul>
            <li><strong>Rang 0 :</strong> "√âquipement bris√© (1d4)"</li>
            <li><strong>Rang 1 :</strong> "√âquipement commun (1d6)"</li>
            <li><strong>Rang 2 :</strong> "√âquipement de qualit√© (1d8)"</li>
            <li><strong>Rang 3 :</strong> "√âquipement rare (1d10)"</li>
            <li><strong>Rang 4 :</strong> "√âquipement exceptionnel (1d12)"</li>
            <li><strong>Rang 5 :</strong> "√âquipement l√©gendaire (1d20)"</li>
        </ul>
    </div>

    <div class="test-section">
        <h2>üß™ Tests √† Effectuer</h2>
        <ol>
            <li>Ouvrir une fiche de personnage</li>
            <li>Aller dans l'onglet "√âquipement"</li>
            <li>V√©rifier que les deux mains (principale et secondaire) affichent correctement la qualit√©</li>
            <li>Changer la qualit√© d'une arme et v√©rifier que l'affichage se met √† jour</li>
            <li>V√©rifier que l'affichage fonctionne pour tous les rangs (0-5)</li>
            <li>V√©rifier que l'affichage fonctionne pour les boucliers aussi</li>
        </ol>
    </div>

    <div class="test-section">
        <h2>üìÅ Fichiers Modifi√©s</h2>
        <ul>
            <li><strong>scripts/heros-sheet.js</strong> - Ajout de la fonction `_getWeaponQualityLabel` et des helpers Handlebars</li>
            <li><strong>templates/sheets/heros-sheet.html</strong> - Mise √† jour des affichages de qualit√© pour les mains principale et secondaire</li>
        </ul>
    </div>

    <div class="test-section">
        <h2>üéâ Avantages de cette Solution</h2>
        <ul>
            <li><span class="success">Affichage coh√©rent</span> - Tous les rangs affichent maintenant le label + d√©s</li>
            <li><span class="success">Lisibilit√© am√©lior√©e</span> - Plus besoin de deviner ce que signifie "3"</li>
            <li><span class="success">Coh√©rence avec l'interface</span> - Les options du select montrent d√©j√† "√âquipement rare (1d10)"</li>
            <li><span class="success">Maintenance facilit√©e</span> - Centralisation des labels dans des helpers r√©utilisables</li>
        </ul>
    </div>

    <div class="test-section">
        <h2>üîç D√©tails Techniques</h2>
        <ul>
            <li><strong>Fonction priv√©e :</strong> `_getWeaponQualityLabel(rank)` dans la classe HeroSheet</li>
            <li><strong>Helpers publics :</strong> `getWeaponQualityLabel` et `getWeaponQualityDice` disponibles dans les templates</li>
            <li><strong>Mapping :</strong> Correspondance 1:1 entre rangs num√©riques et labels descriptifs</li>
            <li><strong>Fallback :</strong> Valeur par d√©faut "√âquipement bris√©" si le rang est invalide</li>
        </ul>
    </div>

    <div class="test-section">
        <h2>üìù Notes de D√©veloppement</h2>
        <p>Cette solution suit le m√™me pattern que les autres helpers Handlebars du syst√®me :</p>
        <ul>
            <li>Fonction priv√©e dans la classe pour la logique m√©tier</li>
            <li>Helper Handlebars public pour l'utilisation dans les templates</li>
            <li>Mapping centralis√© et facilement modifiable</li>
            <li>Gestion des cas d'erreur avec des valeurs par d√©faut</li>
        </ul>
    </div>

    <div class="test-section">
        <h2>üéØ Prochaines √âtapes</h2>
        <p>Cette fonctionnalit√© est maintenant compl√®te et pr√™te pour les tests utilisateur. Les prochaines am√©liorations pourraient inclure :</p>
        <ul>
            <li>Localisation des labels en plusieurs langues</li>
            <li>Personnalisation des labels par type d'√©quipement</li>
            <li>Int√©gration avec le syst√®me de qualit√© des boucliers existant</li>
        </ul>
    </div>

    <div class="test-section">
        <h2>üèÜ Conclusion</h2>
        <p>L'affichage de la qualit√© des armes et boucliers est maintenant <span class="success">coh√©rent et informatif</span>. Les utilisateurs peuvent voir clairement √† la fois le niveau de qualit√© descriptif et le bonus de d√©s correspondant, am√©liorant significativement l'exp√©rience utilisateur de la fiche de personnage.</p>
    </div>
</body>
</html>
